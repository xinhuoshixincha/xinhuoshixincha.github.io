---
layout: post
title:  "GNU/Linux实际id、有效id浅析"
subtitle: ""
date:   2020-04-29 15:44:34 +0800
tags: GNU/Linux
color: rgb(3,212,0)
---

> 本文中的Linux皆为GNU/linux的缩写
>
> 测试系统为centOS

### 实际id（RUID）、有效id（EUID）与对外权限的开放（SUID）

***

> 三者的定义：
>
> RUID表示的是进程的创建者，也就是最开始你登陆的用户的id。——跟用户绑定
>
> EUID表示的是有效的用户id，所谓有效就是用来确定对某些资源和文件的访问权限，一般等于RUID——跟用户绑定
>
> SUID表示对外权限的开放，不同于前两者的是，SUID跟文件绑定，而不是跟用户绑定，最知名的例子是passwd命令。——跟文件绑定

>个人理解：
>
>RUID就是一直不变的，用来唯一性标识一个用户的，相当于我们的身份证号。
>
>EUID是用户在访问文件的时候表现出作用的。比如说文件的访问权限分为三部分：自身：所在组：其他，这里的EUID就是用来给系统分辨你是谁，属于那种，分配哪种访问权限。EUID并不是像RUID一样保持不变的。
>
>SUID是对文件设置的，类似于一个访问助手（或者说如见令牌？）。文件的所有者可以将文件的SUID设置为自己的RUID，这样其他用户访问这个文件的时候就是以文件的所有者权限进行访问的。

#### SUID的作用

这里我就拿著名的passwd案例来说一下。

我们都知道，Linux里面有这么一条命令：passwd，可以用来更改用户自己的密码（root用户可以更改其他用户的密码）。但是Linux是一种遵奉“文件皆一切”的操作系统，也就是说，要修改密码，必须要修改/etc/shadow文件的内容。然而，shadow文件并不对除了root用户外的用户开放
![image-20200429173810896](2020-4-29-GNUI-Linux中的实际id与有效id浅析.assets/image-20200429173810896.png)

所以普通用户并不可能能访问到shadow文件，更谈不上修改密码了。这要怎么办？这时候SUID就派上了用场，
![image-20200429173950029](2020-4-29-GNUI-Linux中的实际id与有效id浅析.assets/image-20200429173950029.png)

如上图所示，passwd的访问权限跟正常的文件访问权限不一样，正常的最后一位是x或者-但他是s，这个s就是意味着所有者为文件设置了SUID，在访问这个文件的时候用户的EUID会同步为文件的SUID，也就是文件所有者的RUID。所以普通用户在用passwd命令的时候，权限其实是root的权限（部分）。